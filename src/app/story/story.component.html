<mat-card class="container">
    <mat-form-field appearance="outline" class="full-width">
      <mat-label>Vælg en hovedkategori</mat-label>
      <mat-select [(ngModel)]="mainCategory" (selectionChange)="updateSubcategories()">
        <mat-option value="sport">Sport</mat-option>
        <mat-option value="music">Musik</mat-option>
        <mat-option value="science">Videnskab</mat-option>
        <mat-option value="history">Historie</mat-option>
        <mat-option value="film">Film & TV</mat-option>
        <mat-option value="nature">Natur & Miljø</mat-option>
        <mat-option value="space">Rummet</mat-option>
      </mat-select>
    </mat-form-field>
  
    <mat-form-field appearance="outline" class="full-width" *ngIf="mainCategory">
      <mat-label>Vælg en underkategori</mat-label>
      <mat-select [(ngModel)]="subCategory">
        <mat-option *ngFor="let sub of subcategories" [value]="sub">{{ sub }}</mat-option>
      </mat-select>
    </mat-form-field>
  
    <mat-form-field appearance="outline" class="full-width" *ngIf="subCategory">
      <mat-label>Indtast specifikt emne</mat-label>
      <input matInput [(ngModel)]="inputTopic" placeholder="Fx Einstein, The Beatles, eller Romerriget">
    </mat-form-field>
  
    <mat-form-field appearance="outline" class="full-width">
      <mat-label>Vælg Klassetrin</mat-label>
      <mat-select [(ngModel)]="selectedGrade">
        <mat-option *ngFor="let grade of gradeLevels" [value]="grade">Klasse {{ grade }}</mat-option>
      </mat-select>
    </mat-form-field>
  
    <button mat-raised-button color="primary" (click)="generateStory()" [disabled]="loading || !inputTopic || !selectedGrade">
      Generér Historie
    </button>
  
    <mat-progress-spinner *ngIf="loading" mode="indeterminate"></mat-progress-spinner>
  
    <mat-card *ngIf="story.length > 0" class="story-box">
      <h2>Genereret Historie:</h2>
      <div *ngFor="let chapter of story; let i = index">
        <h3>Kapitel {{ i + 1 }} - {{chapter.title}}</h3>
        <p>{{ chapter.text }}</p>
        <div *ngFor="let img of chapter.images">
          <img [src]="img" class="chapter-image" *ngIf="img">
        </div>
      </div>
      <button mat-raised-button color="accent" (click)="saveStory()">Gem Historie</button>
  
      <mat-card *ngIf="previousQuizResult">
        <h3>Tidligere Quizresultat</h3>
        <p>Du fik {{ previousQuizResult.score }} / {{ previousQuizResult.totalQuestions }} rigtige!</p>
      </mat-card>
  
      <button mat-raised-button color="primary" (click)="startQuiz()">Tag Quiz</button>
    </mat-card>
  
    <app-quiz *ngIf="quizAvailable" [quiz]="quizData" (quizCompleted)="onQuizCompleted($event)"></app-quiz>
  </mat-card>